
# GutyaGutya3 ソフトウェア仕様

## 1. 概要

GutyaGutya3（ぐちゃぐちゃあっぷ）は、ユーザーが入力したテキストを指定されたルールに基づいて変換（"ぐちゃぐちゃ化"）するウェブアプリケーションである。変換の度合いは「レベル」によって調整可能であり、特定の文字セット（例：ルーン文字、ヒエログリフなど）へのマッピングもサポートする。

## 2. 機能仕様

### 2.1. テキスト入力
- ユーザーは任意のテキストを専用のテキストエリアに入力できる。
- 初期値として「ここに入力」というプレースホルダーテキストが表示される。

### 2.2. 変換レベル選択
- ユーザーは変換の複雑さを決定する「レベル」を1から5の間で選択できる。
- デフォルトのレベルは5である。

### 2.3. 文字種選択
- ユーザーは変換時に文字コードを特定の範囲に丸める「文字種」を選択できる。
- この機能は変換レベル3以上で適用される。
- 選択可能な文字種には、「選択しない」（丸め処理なし）および以下のものが含まれる：
    - ビルマ文字 (0x1000 - 0x109F)
    - アラビア文字 (0x0600 - 0x06FF)
    - ルーン文字 (0x16A0 - 0x16F0)
    - ルーン文字+ (0x16A0 - 0x16F8)
    - タイ文字 (0x0E01 - 0x0E5B)
    - グルジア文字 (0x10A0 - 0x10FF)
    - シンハラ文字 (0x0D80 - 0x0DF4)
    - テルグ文字 (0x0C00 - 0x0C7F)
    - カンナダ文字 (0x0C80 - 0x0CF3)
    - マラヤーラム文字 (0x0D00 - 0x0D7F)
    - ヒエログリフ (0x13000 - 0x1342F)
    - パスパ文字 (0xA840 - 0xA87E)
    - ブラーフミー文字 (0x11000 - 0x1107F)
    - ヴァイ文字 (0xA500 - 0xA62B)
    - デーヴァナーガリー (0x0900 - 0x097F)
- デフォルトでは「選択しない」が選択されている。

### 2.4. 変換実行
- 「変換実行」ボタンをクリックすることで、入力テキストが現在の設定（レベル、文字種）に基づいて変換される。
- 入力テキスト、レベル、または文字種が変更されると、変換結果は自動的に更新される。

### 2.5. 変換結果表示
- 変換後のテキストは専用のテキストエリアに表示される。
- このテキストエリアは読み取り専用である。

### 2.6. スキップ対象文字
以下の文字は変換処理の対象外（スキップ）となる：
- **区切り文字:** 空白文字（半角・全角スペース）、改行、タブ、カンマ、ピリオド、中点、セミコロン、コロン、アポストロフィ、引用符、バックスラッシュ、縦線、各種括弧（「」《》【】()（）『』〚〛）、長音記号、疑問符、感嘆符。
- **数字:** 0-9、０-９。
- **Unicode制御文字・未割り当て文字:** `\p{C}` に該当する文字。

### 2.7. 変換アルゴリズム

1.  **文字列分割 (`Split`):**
    入力テキストは、スキップ対象の区切り文字で単語単位に分割される。区切り文字自体も保持される。

2.  **コア変換処理 (`Execute`):**
    分割された各単語（区切り文字でない部分）に対して、選択されたレベルに応じた処理が実行される。

    *   **レベル1 (`strSwap`):**
        単語内の文字を先頭から2文字ずつのペアにし、各ペアの文字を入れ替える。奇数長の場合、最後の1文字はそのまま残る。
        例: "ABCDE" -> "BACDE"

    *   **レベル2:**
        単語全体の文字の並びを反転 (`strReverse`) させた後、レベル1の処理 (`strSwap`) を適用する。
        例: "ABCDE" -> 反転 "EDCBA" -> `strSwap` "DECAB"

    *   **レベル3以上:**
        各文字に対して文字コードのシフト処理 (`getNextChar`) を行った後、レベル2の処理を適用する。
        -   **文字コードシフト (`getNextChar`):**
            -   スキップ対象文字は変更されない。
            -   シフト量は `(現在のレベル - 3) + 単語の長さ` で決定される。
            -   文字コードにシフト量を加算する。
            -   「文字種」が「選択しない」以外の場合、シフト後の文字コードを指定された文字種の範囲 (`Minimum` から `Maximum`) に丸める（剰余演算を使用）。
            -   `String.fromCodePoint()` で新しい文字を生成する。
            -   生成された文字がスキップ対象文字であり、かつ元の文字がスキップ対象文字でなかった場合、さらに文字コードを1増やして再生成を試みる。それでもスキップ対象文字になる場合は元の文字を返す。
            -   `codePointAt(0)` や `fromCodePoint()` でエラーが発生した場合は元の文字を返す。

3.  **文字列結合:**
    処理された各部分（変換された単語および区切り文字）を元の順序で結合し、最終的な変換結果とする。

### 2.8. ヘルプ表示
- アプリケーションのUI内に、使用方法と各レベルの詳細を説明するヘルプセクションが表示される。

## 3. 技術スタック
- **フロントエンド:** React (v19), TypeScript
- **スタイリング:** Tailwind CSS
- **状態管理:** React Hooks (`useState`, `useEffect`)

## 4. UIコンポーネント構成
- `App.tsx`: アプリケーション全体のレイアウトとメインコンテナ。
- `components/Form.tsx`: 入力フォーム、制御要素（レベル選択、文字種選択、変換ボタン）、結果表示エリア、変換ロジックを含むコアコンポーネント。
- `components/Help.tsx`: 使用方法やレベル詳細を表示するヘルプ情報コンポーネント。

## 5. レスポンシブデザイン
- Tailwind CSSのユーティリティクラスを使用し、スマートフォンからデスクトップまで、さまざまな画面サイズに対応した表示を行う。
- 主要なコントロール（レベル選択、文字種選択、変換ボタン）は、画面幅に応じてレイアウトが調整される（例：スマートフォンでは縦積み、デスクトップでは横並びの可能性も考慮したグリッドレイアウト）。

## 6. アクセシビリティ
- フォーム要素には `label` タグや `aria-label` 属性を使用して、スクリーンリーダー等によるアクセスを支援する。
- フォーカス時のスタイル（リング表示など）を適切に設定する。
